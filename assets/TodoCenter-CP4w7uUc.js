import{e as A,v as I,w as n,s as l,x as z,P as G,y as W,o as $,l as L,E as s,D as t,F as e,Q as h,J as o,G as u,K as U,T as F,C as c,V as v,U as m,W as T,r as x,j as y,M as K,_ as J}from"./index-BsKuKuBe.js";import{S as Q}from"./SpeedometerOutline-CKasUOHz.js";import{R as q}from"./Refresh-N_ZHlcGf.js";import{A as X}from"./AlertCircleOutline-CuEJ5tgw.js";import{P as Y}from"./PulseOutline-CvB9uYtt.js";import{N as Z}from"./Popover-CfBNgOAF.js";import{P as ee}from"./PeopleOutline-CQmmVffL.js";import{N as j}from"./Space-Cf9Hs1lp.js";import{N as p}from"./text-BDsrB_Xz.js";import{N as f}from"./Icon-CbayTH31.js";import{N as w}from"./Statistic-C8A6-kum.js";import{N as D}from"./Tag-I3_cH6qL.js";import"./use-compitable-BjMNwQgq.js";const te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},se=A({name:"CardOutline",render:function(k,d){return l(),I("svg",te,d[0]||(d[0]=[n("rect",{x:"48",y:"96",width:"416",height:"320",rx:"56",ry:"56",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),n("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"60",d:"M48 192h416"},null,-1),n("path",{fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"60",d:"M128 300h48v20h-48z"},null,-1)]))}}),ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},re=A({name:"CashOutline",render:function(k,d){return l(),I("svg",ae,d[0]||(d[0]=[z('<rect x="32" y="80" width="448" height="256" rx="16" ry="16" transform="rotate(180 256 208)" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M64 384h384"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M96 432h320"></path><circle cx="256" cy="208" r="80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><path d="M480 160a80 80 0 0 1-80-80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M32 160a80 80 0 0 0 80-80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M480 256a80 80 0 0 0-80 80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path d="M32 256a80 80 0 0 1 80 80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path>',8)]))}}),oe=g=>new Promise(k=>setTimeout(k,g)),le={async getTodoStats(){return await oe(500),{code:0,msg:"success",data:{pendingDeposits:3,pendingWithdrawals:12,riskAlerts:5,apiHealth:{status:"healthy",failedServices:[]},ccu:12450}}}},ne={class:"todo-center-container"},ie={class:"card-action"},de={class:"card-action"},ue={class:"card-action"},ce={class:"card-action"},pe={class:"card-action"},fe=3e4,he=5e3,ke=A({__name:"TodoCenter",setup(g){const k=K(),d=G(),M=W(),C=x(!1),_=x(!1),E=x(""),r=x({pendingDeposits:0,pendingWithdrawals:0,riskAlerts:0,apiHealth:{status:"healthy",failedServices:[]},ccu:0});let N=null;const P=y(()=>{var a;const i=(a=M.user)==null?void 0:a.role;return["DEVELOPER","MANAGER","FINANCE"].includes(i||"")}),H=y(()=>{var a;const i=(a=M.user)==null?void 0:a.role;return["DEVELOPER","MANAGER","RISK"].includes(i||"")}),V=y(()=>r.value.apiHealth.status==="healthy"?"正常":r.value.apiHealth.status==="degraded"?"部分異常":"服務中斷"),B=y(()=>r.value.apiHealth.status==="healthy"?"text-success":"text-danger"),S=async(i=!1)=>{i||(C.value=!0);try{const a=await le.getTodoStats();a.code===0&&a.data&&(r.value=a.data,E.value=new Date().toLocaleTimeString())}catch{d.error("數據更新失敗")}finally{i||(C.value=!1)}},O=()=>{_.value||(S(),_.value=!0,setTimeout(()=>{_.value=!1},he))},b=(i,a)=>{k.push({path:i,query:a})};return $(()=>{S(),N=window.setInterval(()=>S(!0),fe)}),L(()=>{N&&clearInterval(N)}),(i,a)=>(l(),I("div",ne,[s(e(j),{vertical:"",size:"large"},{default:t(()=>[s(e(h),null,{default:t(()=>[s(e(j),{justify:"space-between",align:"center"},{default:t(()=>[s(e(p),{h2:"",style:{margin:"0"}},{default:t(()=>[s(e(f),null,{default:t(()=>[s(e(Q))]),_:1}),a[3]||(a[3]=o(" 待辦審核中心 (Todo Center) ",-1))]),_:1}),s(e(j),{align:"center"},{default:t(()=>[s(e(p),{depth:"3"},{default:t(()=>[o("最後更新: "+u(E.value),1)]),_:1}),s(e(U),{type:"primary",secondary:"",circle:"",loading:C.value,disabled:_.value,onClick:O},{icon:t(()=>[s(e(f),null,{default:t(()=>[s(e(q))]),_:1})]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),s(e(F),{"x-gap":"16","y-gap":"16",cols:4,"item-responsive":""},{default:t(()=>[P.value?(l(),c(e(m),{key:0},{default:t(()=>[s(e(h),{class:v(["todo-card",{"status-warn":r.value.pendingDeposits>0}]),hoverable:"",onClick:a[0]||(a[0]=R=>b("/finance/deposit-orders",{status:"pending"}))},{default:t(()=>[s(e(w),{label:"儲值待補單"},{prefix:t(()=>[s(e(f),null,{default:t(()=>[s(e(se))]),_:1})]),default:t(()=>[o(" "+u(r.value.pendingDeposits),1)]),_:1}),n("div",ie,[s(e(p),{depth:"3",class:"text-xs"},{default:t(()=>[...a[4]||(a[4]=[o("點擊前往處理 >>",-1)])]),_:1})])]),_:1},8,["class"])]),_:1})):T("",!0),P.value?(l(),c(e(m),{key:1},{default:t(()=>[s(e(h),{class:v(["todo-card",{"status-warn":r.value.pendingWithdrawals>0}]),hoverable:"",onClick:a[1]||(a[1]=R=>b("/finance/withdraw-audit",{status:"pending"}))},{default:t(()=>[s(e(w),{label:"提款待審核"},{prefix:t(()=>[s(e(f),null,{default:t(()=>[s(e(re))]),_:1})]),default:t(()=>[o(" "+u(r.value.pendingWithdrawals),1)]),_:1}),n("div",de,[s(e(p),{depth:"3",class:"text-xs"},{default:t(()=>[...a[5]||(a[5]=[o("點擊前往處理 >>",-1)])]),_:1})])]),_:1},8,["class"])]),_:1})):T("",!0),H.value?(l(),c(e(m),{key:2},{default:t(()=>[s(e(h),{class:v(["todo-card",{"status-danger":r.value.riskAlerts>0}]),hoverable:"",onClick:a[2]||(a[2]=R=>b("/risk/alerts",{status:"unresolved"}))},{default:t(()=>[s(e(w),{label:"異常行為預警","label-class":"risk-alert-label"},{prefix:t(()=>[s(e(f),null,{default:t(()=>[s(e(X))]),_:1})]),default:t(()=>[o(" "+u(r.value.riskAlerts),1)]),_:1}),n("div",ue,[r.value.riskAlerts>0?(l(),c(e(D),{key:0,type:"error",size:"small"},{default:t(()=>[...a[6]||(a[6]=[o("High Risk",-1)])]),_:1})):(l(),c(e(p),{key:1,depth:"3",class:"text-xs"},{default:t(()=>[...a[7]||(a[7]=[o("系統監控中",-1)])]),_:1}))])]),_:1},8,["class"])]),_:1})):T("",!0),s(e(m),null,{default:t(()=>[s(e(h),{class:v(["todo-card",{"status-danger":r.value.apiHealth.status!=="healthy"}])},{default:t(()=>[s(e(w),{label:"系統健康度"},{prefix:t(()=>[s(e(f),null,{default:t(()=>[s(e(Y))]),_:1})]),default:t(()=>[n("span",{class:v(B.value)},u(V.value),3)]),_:1}),n("div",ce,[r.value.apiHealth.failedServices.length>0?(l(),c(e(Z),{key:0,trigger:"hover"},{trigger:t(()=>[s(e(D),{type:"error",size:"small"},{default:t(()=>[...a[8]||(a[8]=[o("異常檢測",-1)])]),_:1})]),default:t(()=>[n("span",null,u(r.value.apiHealth.failedServices.join(", ")),1)]),_:1})):(l(),c(e(p),{key:1,depth:"3",class:"text-xs"},{default:t(()=>[...a[9]||(a[9]=[o("All Systems Operational",-1)])]),_:1}))])]),_:1},8,["class"])]),_:1}),s(e(m),null,{default:t(()=>[s(e(h),{class:"todo-card status-neutral"},{default:t(()=>[s(e(w),{label:"即時在線 (CCU)"},{prefix:t(()=>[s(e(f),null,{default:t(()=>[s(e(ee))]),_:1})]),default:t(()=>[o(" "+u(r.value.ccu.toLocaleString()),1)]),_:1}),n("div",pe,[s(e(p),{depth:"3",class:"text-xs"},{default:t(()=>[...a[10]||(a[10]=[o("實時更新",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Ae=J(ke,[["__scopeId","data-v-56e0681b"]]);export{Ae as default};
