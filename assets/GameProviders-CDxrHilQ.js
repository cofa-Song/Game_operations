import{e as F,A as G,P as j,y as q,r as u,h as m,K as y,o as K,v as A,E as o,D as r,F as e,Y as I,aN as Y,T as z,U as h,Z as p,w as N,J as w,G as v,Q as O,W as J,$ as Q,a1 as W,a0 as Z,j as H,s as P}from"./index-BsKuKuBe.js";import{p as C}from"./provider-B_TH2Ac7.js";import{C as X}from"./CreateOutline-CbXbgX50.js";import{S as ee}from"./SearchOutline-tjJoWZeT.js";import{R as ae}from"./RefreshOutline-DGpX8rVm.js";import{N as te}from"./Tag-I3_cH6qL.js";import{N as S}from"./Select-CCDzjsmj.js";import{N as oe}from"./DatePicker-CVYfnur-.js";import{N as le}from"./DataTable-D5mRR0cm.js";import{N as re}from"./InputNumber-BMu_ZOnr.js";import"./Popover-CfBNgOAF.js";import"./use-compitable-BjMNwQgq.js";import"./create-Bj8PAPmY.js";import"./Empty-DtuLCoXR.js";import"./use-keyboard-kkRvbDTj.js";import"./Forward-CBwL8ab_.js";import"./Radio-C5fS5KPL.js";import"./RadioGroup-CgIVku-C.js";import"./Tooltip-XZFA5Owl.js";import"./Dropdown-CcmdnIk3.js";import"./Icon-CbayTH31.js";import"./create-ref-setter-C4J8sofl.js";import"./Pagination-BLbp2o8H.js";import"./Add-BJRbFrfV.js";const se={class:"p-6"},ne={class:"flex justify-end gap-2"},de={key:0,class:"mb-4 p-3 bg-gray-50 rounded"},ie={class:"font-semibold"},ue={class:"text-xs text-gray-500"},me={class:"flex justify-end gap-2"},Ue=F({__name:"GameProviders",setup(pe){const{t:a}=G(),c=j(),L=q(),b=u(!1),T=u([]),n=Z({code:"",type:void 0,status:void 0,date_start:void 0,date_end:void 0}),D=()=>{const t=new Date,l=new Date;return l.setDate(t.getDate()-7),[l.getTime(),t.getTime()]},k=u([]),R=H(()=>k.value.map(t=>({label:`${t.name} (${t.code})`,value:t.code}))),f=u(D()),M=[{label:a("game.provider.types.SLOT"),value:"SLOT"},{label:a("game.provider.types.LIVE"),value:"LIVE"},{label:a("game.provider.types.SPORTS"),value:"SPORTS"},{label:a("game.provider.types.LOTTERY"),value:"LOTTERY"},{label:a("game.provider.types.CARD"),value:"CARD"}],E=[{label:a("common.enable"),value:"ACTIVE"},{label:a("common.disable"),value:"DISABLED"},{label:a("game.provider.maintenance"),value:"MAINTENANCE"}],x=t=>"$ "+t.toLocaleString(),_=u(!1),i=u(null),d=u({status:void 0,sort_order:void 0,reason:""}),U=[{title:a("game.provider.id"),key:"id",width:100},{title:a("game.provider.vendorCode"),key:"code",width:100},{title:a("game.provider.name"),key:"name",width:150},{title:a("game.provider.platformType"),key:"type",width:100,render:t=>a(`game.provider.types.${t.type}`)||t.type},{title:a("game.provider.status"),key:"status",width:100,render:t=>{const l={ACTIVE:"success",MAINTENANCE:"warning",DISABLED:"error"},s={ACTIVE:a("common.enable"),MAINTENANCE:a("game.provider.maintenance"),DISABLED:a("common.disable")};return m(te,{type:l[t.status],bordered:!1},{default:()=>s[t.status]})}},{title:a("game.provider.sortOrder"),key:"sort_order",width:80,render:t=>m("span",{class:"font-mono"},t.sort_order)},{title:a("game.provider.currentPlayers"),key:"current_players",width:120,render:t=>m("span",t.current_players.toLocaleString())},{title:a("game.provider.totalBet"),key:"total_bet",width:150,render:t=>m("span",{class:"text-orange-600 font-semibold"},x(t.total_bet))},{title:a("game.provider.totalPayout"),key:"total_payout",width:150,render:t=>m("span",{class:"text-green-600 font-semibold"},x(t.total_payout))},{title:a("common.action"),key:"actions",width:80,fixed:"right",render:t=>m(y,{size:"small",secondary:!0,onClick:()=>B(t)},{icon:()=>m(X)})}],g=async()=>{b.value=!0;try{f.value?(n.date_start=new Date(f.value[0]).toISOString(),n.date_end=new Date(f.value[1]).toISOString()):(n.date_start=void 0,n.date_end=void 0);const t=await C.getProviders(n);t.code===0?T.value=t.data:c.error(t.msg)}catch{c.error(a("common.error"))}finally{b.value=!1}},V=()=>{n.code="",n.type=void 0,n.status=void 0,f.value=D(),g()},B=t=>{i.value=t,d.value={status:t.status,sort_order:t.sort_order,reason:""},_.value=!0},$=async()=>{var t;if(i.value){if(!d.value.reason){c.warning(a("game.provider.reasonPlaceholder"));return}try{const l=await C.updateProvider(i.value.id,d.value,((t=L.user)==null?void 0:t.user_id)||"admin");l.code===0?(c.success(a("common.success")),_.value=!1,g()):c.error(l.msg)}catch{c.error(a("common.error"))}}};return K(async()=>{const t=await C.getProviders();t.code===0&&(k.value=t.data),g()}),(t,l)=>(P(),A("div",se,[o(e(O),{title:e(a)("game.provider.title"),class:"mb-4"},{default:r(()=>[o(e(I),{inline:"",model:n,"label-placement":"left","label-width":"auto",onKeypress:Y(g,["enter"])},{default:r(()=>[o(e(z),{cols:24,"x-gap":12},{default:r(()=>[o(e(h),{span:6},{default:r(()=>[o(e(p),{label:e(a)("game.provider.vendorCode")},{default:r(()=>[o(e(S),{value:n.code,"onUpdate:value":l[0]||(l[0]=s=>n.code=s),options:R.value,placeholder:e(a)("common.all"),clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(h),{span:6},{default:r(()=>[o(e(p),{label:e(a)("game.provider.platformType")},{default:r(()=>[o(e(S),{value:n.type,"onUpdate:value":l[1]||(l[1]=s=>n.type=s),options:M,placeholder:e(a)("common.all"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(h),{span:6},{default:r(()=>[o(e(p),{label:e(a)("common.status")},{default:r(()=>[o(e(S),{value:n.status,"onUpdate:value":l[2]||(l[2]=s=>n.status=s),options:E,placeholder:e(a)("common.all"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),o(e(h),{span:6},{default:r(()=>[o(e(p),{label:e(a)("game.provider.date")},{default:r(()=>[o(e(oe),{value:f.value,"onUpdate:value":l[3]||(l[3]=s=>f.value=s),type:"datetimerange",clearable:""},null,8,["value"])]),_:1},8,["label"])]),_:1}),o(e(h),{span:24},{default:r(()=>[N("div",ne,[o(e(y),{secondary:"",onClick:V},{default:r(()=>[w(v(e(a)("common.all")),1)]),_:1}),o(e(y),{type:"primary",onClick:g,loading:b.value},{icon:r(()=>[o(e(ee))]),default:r(()=>[w(" "+v(e(a)("common.search")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]),o(e(O),null,{"header-extra":r(()=>[o(e(y),{secondary:"",circle:"",onClick:g,loading:b.value},{icon:r(()=>[o(e(ae))]),_:1},8,["loading"])]),default:r(()=>[o(e(le),{columns:U,data:T.value,loading:b.value,pagination:!1,bordered:!1,"scroll-x":1200},null,8,["data","loading"])]),_:1}),o(e(W),{show:_.value,"onUpdate:show":l[8]||(l[8]=s=>_.value=s),preset:"card",title:e(a)("game.provider.editStatus"),style:{width:"500px"}},{footer:r(()=>[N("div",me,[o(e(y),{onClick:l[7]||(l[7]=s=>_.value=!1)},{default:r(()=>[w(v(e(a)("common.cancel")),1)]),_:1}),o(e(y),{type:"primary",onClick:$},{default:r(()=>[w(v(e(a)("common.save")),1)]),_:1})])]),default:r(()=>[i.value?(P(),A("div",de,[N("div",ie,v(i.value.name),1),N("div",ue,v(i.value.code)+" | "+v(i.value.id),1)])):J("",!0),o(e(I),{model:d.value,"label-placement":"left","label-width":"80"},{default:r(()=>[o(e(p),{label:e(a)("common.status"),required:""},{default:r(()=>[o(e(S),{value:d.value.status,"onUpdate:value":l[4]||(l[4]=s=>d.value.status=s),options:E},null,8,["value"])]),_:1},8,["label"]),o(e(p),{label:e(a)("game.provider.sortOrder"),required:""},{default:r(()=>[o(e(re),{value:d.value.sort_order,"onUpdate:value":l[5]||(l[5]=s=>d.value.sort_order=s),min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1},8,["label"]),o(e(p),{label:e(a)("game.provider.reason"),required:""},{default:r(()=>[o(e(Q),{type:"textarea",value:d.value.reason,"onUpdate:value":l[6]||(l[6]=s=>d.value.reason=s),placeholder:e(a)("game.provider.reasonPlaceholder"),rows:3},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["show","title"])]))}});export{Ue as default};
