import{e as B,h as G,ae as V,Z as W,U as Z,aO as H,aP as X,r as _,aQ as q,aR as ee,P as te,A as ae,v as x,E as a,D as o,F as t,K as A,J as p,G as z,W as k,C as P,I as le,Y as ne,T as oe,$ as T,Q as se,a1 as ie,j as F,a0 as re,s as d,_ as ue}from"./index-BsKuKuBe.js";import{u as pe}from"./composables-FnfCle_S.js";import{N as de}from"./Spin-D6NC1_9t.js";import{N}from"./Divider-DILe50Hg.js";import{N as C}from"./Switch-DXNn_bI_.js";import{N as b}from"./text-BDsrB_Xz.js";import{N as c}from"./InputNumber-BMu_ZOnr.js";import{N as M}from"./Select-CCDzjsmj.js";import{N as me}from"./Space-Cf9Hs1lp.js";import"./use-compitable-BjMNwQgq.js";import"./Add-BJRbFrfV.js";import"./Popover-CfBNgOAF.js";import"./Tag-I3_cH6qL.js";import"./create-Bj8PAPmY.js";import"./Empty-DtuLCoXR.js";const _e=Object.assign(Object.assign({},q),ee),i=B({__GRID_ITEM__:!0,name:"FormItemGridItem",alias:["FormItemGi"],props:_e,setup(){const r=_(null);return{formItemInstRef:r,validate:(...f)=>{const{value:w}=r;if(w)return w.validate(...f)},restoreValidation:()=>{const{value:f}=r;f&&f.restoreValidation()}}},render(){return G(Z,V(this.$.vnode.props||{},X),{default:()=>{const r=V(this.$props,H);return G(W,Object.assign({ref:"formItemInstRef"},r),this.$slots)}})}}),fe=()=>new Date().toISOString(),y={maintenance_enabled:!1,maintenance_message:{zh:"ç³»çµ±æ­£åœ¨å‡ç´šç¶­è­·ä¸­ï¼Œè«‹ç¨å€™...","zh-CN":"ç³»ç»Ÿæ­£åœ¨å‡çº§ç»´æŠ¤ä¸­ï¼Œè¯·ç¨å€™..."},maintenance_kickout_delay_seconds:30,allow_test_login:!0,registration_enabled:!0,site_title:"Yotaå¨›æ¨‚åŸŽ",default_language:"zh-TW",timezone:"Asia/Taipei",p2p_transaction_fee:5,bonus_rollover_multiplier:20,registration_bonus_amount:100,rollover_settlement_threshold:.99,login_error_limit:5,captcha_enabled:!0,force_phone_binding:!1,whitelist_ips:`127.0.0.1
192.168.1.1`,payout_threshold_multiplier:2,password_reset_cooldown_hours:24,session_timeout_minutes:120,updated_at:fe(),updated_by:"admin"},j=(r=300)=>new Promise(u=>setTimeout(u,r)),$={async get(){return await j(),{code:0,msg:"success",data:y}},async update(r,u){return await j(),r.bonus_rollover_multiplier!==void 0&&r.bonus_rollover_multiplier<0?{code:400,msg:"Bonus rollover multiplier cannot be negative"}:r.registration_bonus_amount!==void 0&&r.registration_bonus_amount<0?{code:400,msg:"Registration bonus cannot be negative"}:r.login_error_limit!==void 0&&r.login_error_limit<1?{code:400,msg:"Login error limit must be at least 1"}:(console.log(`[Audit] Config Update: ${u}`,{before:y,after:{...y,...r}}),Object.assign(y,r,{updated_at:new Date().toISOString()}),{code:0,msg:"success"})},async isUnderMaintenance(){return await j(50),{code:0,msg:"success",data:{maintenance:y.maintenance_enabled,message:y.maintenance_message.zh}}}},ge={class:"operation-config"},ve={key:0,class:"mb-4 flex gap-2"},be={key:0,class:"ml-1"},ce=B({__name:"OperationConfig",setup(r){const u=te(),D=pe(),{t:f}=ae(),w=_(),I=_(!1),O=_(!1),g=_(!1),h=_(""),m=_(null),E=[{label:"ç¹é«”ä¸­æ–‡",value:"zh-TW"},{label:"ç°¡é«”ä¸­æ–‡",value:"zh-CN"},{label:"English",value:"en"}],J=[{label:"(UTC+08:00) å°åŒ—",value:"Asia/Taipei"},{label:"(UTC+08:00) åŒ—äº¬",value:"Asia/Shanghai"},{label:"(UTC+00:00) å€«æ•¦",value:"UTC"}],S=F(()=>{const s={};if(!m.value)return s;for(const e of Object.keys(n)){const l=n[e],v=m.value[e];typeof l=="object"&&l!==null?JSON.stringify(l)!==JSON.stringify(v)&&(s[e]=l):l!==v&&(s[e]=l)}return s}),U=F(()=>Object.keys(S.value).length),n=re({maintenance_enabled:!1,maintenance_message:{zh:"","zh-CN":""},maintenance_kickout_delay_seconds:30,allow_test_login:!0,registration_enabled:!0,site_title:"",default_language:"zh-TW",timezone:"Asia/Taipei",p2p_transaction_fee:5,bonus_rollover_multiplier:20,registration_bonus_amount:100,rollover_settlement_threshold:.99,login_error_limit:5,captcha_enabled:!0,force_phone_binding:!1,whitelist_ips:""}),K={maintenance_kickout_delay_seconds:{type:"number",min:0,message:"è«‹è¼¸å…¥æœ‰æ•ˆçš„æ•´æ•¸",trigger:["blur","change"]},site_title:{required:!0,message:"è«‹è¼¸å…¥ç¶²ç«™æ¨™é¡Œ",trigger:"blur"},p2p_transaction_fee:{type:"number",min:0,max:100,message:"æ‰‹çºŒè²»æ‡‰åœ¨ 0-100% ä¹‹é–“",trigger:["blur","change"]},bonus_rollover_multiplier:{type:"number",min:0,max:100,message:"æµæ°´å€æ•¸æ‡‰åœ¨ 0-100 ä¹‹é–“",trigger:["blur","change"]},registration_bonus_amount:{type:"number",min:0,message:"é‡‘é¡ä¸æ­£ç¢º",trigger:["blur","change"]},login_error_limit:{type:"number",min:1,max:20,message:"éŒ¯èª¤ä¸Šé™æ‡‰åœ¨ 1-20 ä¹‹é–“",trigger:["blur","change"]}},R=async()=>{try{I.value=!0;const s=await $.get();s.code===0&&s.data?(m.value=s.data,Object.assign(n,s.data)):u.error(s.msg||"è¼‰å…¥è¨­å®šå¤±æ•—")}catch(s){u.error("è¼‰å…¥è¨­å®šç•°å¸¸"),console.error(s)}finally{I.value=!1}},L=async()=>{var s,e;try{if(await((s=w.value)==null?void 0:s.validate()),n.bonus_rollover_multiplier===0&&((e=m.value)==null?void 0:e.bonus_rollover_multiplier)!==0&&!await new Promise(v=>{D.warning({title:"ç¢ºèª",content:"æ‚¨æ­£åœ¨å°‡æµæ°´å€æ•¸è¨­ç‚º 0ï¼Œé€™å°‡ä½¿æ‰€æœ‰è´ˆé»žé è¨­ç„¡æµæ°´é™åˆ¶ï¼Œç¢ºå®šè¦ç¹¼çºŒå—Žï¼Ÿ",positiveText:"ç¢ºèª",negativeText:"å–æ¶ˆ",onPositiveClick:()=>v(!0),onNegativeClick:()=>v(!1),onClose:()=>v(!1)})}))return;if(U.value===0){u.info("æ²’æœ‰ä»»ä½•è®Šæ›´");return}h.value="",g.value=!0}catch{u.error("è¡¨å–®é©—è­‰å¤±æ•—")}},Q=async()=>{if(!h.value.trim()){u.warning("è«‹å¡«å¯«è®Šæ›´åŽŸå› ");return}if(S.value)try{O.value=!0;const s=await $.update(S.value,h.value);s.code===0?(u.success("è¨­å®šå·²æ›´æ–°"),g.value=!1,await R()):u.error(s.msg||"æ›´æ–°å¤±æ•—")}catch(s){u.error("æ›´æ–°ç•°å¸¸"),console.error(s)}finally{O.value=!1}},Y=s=>s?new Date(s).toLocaleString("zh-TW"):"-";return R(),(s,e)=>(d(),x("div",ge,[a(t(se),{title:t(f)("navigation.operationConfig"),segmented:{content:!0,footer:"soft"}},{default:o(()=>[I.value?k("",!0):(d(),x("div",ve,[a(t(A),{type:"warning",disabled:U.value===0,onClick:L,loading:O.value},{default:o(()=>[e[20]||(e[20]=p(" å­˜å–æ“ä½œ ",-1)),U.value>0?(d(),x("span",be,"("+z(U.value)+")",1)):k("",!0)]),_:1},8,["disabled","loading"])])),I.value?(d(),P(t(de),{key:1})):(d(),x(le,{key:2},[a(t(ne),{ref_key:"formRef",ref:w,model:n,rules:K,"label-placement":"left","label-width":"180px"},{default:o(()=>[a(t(oe),{cols:24,"x-gap":24},{default:o(()=>[a(t(i),{span:24},{default:o(()=>[a(t(N),{"title-placement":"left"},{default:o(()=>[...e[21]||(e[21]=[p("ç‡Ÿé‹èˆ‡ç¶­è­·",-1)])]),_:1})]),_:1}),a(t(i),{span:12,label:"å…¨ç«™ç¶­è­·é–‹é—œ",path:"maintenance_enabled"},{default:o(()=>[a(t(C),{value:n.maintenance_enabled,"onUpdate:value":e[0]||(e[0]=l=>n.maintenance_enabled=l)},null,8,["value"]),n.maintenance_enabled?(d(),P(t(b),{key:0,type:"warning",class:"ml-2"},{default:o(()=>[...e[22]||(e[22]=[p(" ç¶­è­·ä¸­ (ç¦æ­¢è¨ªå•) ",-1)])]),_:1})):k("",!0)]),_:1}),a(t(i),{span:12,label:"å¼·åˆ¶è¸¢ç·š (ç§’)",path:"maintenance_kickout_delay_seconds"},{default:o(()=>[a(t(c),{value:n.maintenance_kickout_delay_seconds,"onUpdate:value":e[1]||(e[1]=l=>n.maintenance_kickout_delay_seconds=l),min:0},null,8,["value"])]),_:1}),a(t(i),{span:24,label:"ç¶­è­·å…¬å‘Šå…§å®¹",path:"maintenance_message.zh"},{default:o(()=>[a(t(T),{value:n.maintenance_message.zh,"onUpdate:value":e[2]||(e[2]=l=>n.maintenance_message.zh=l),type:"textarea",placeholder:"ç¶­è­·æ™‚å‰ç«¯é¡¯ç¤ºçš„è‡ªå®šç¾©æ–‡å­—",rows:2},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"å…è¨±æ¸¬è©¦ç™»å…¥",path:"allow_test_login"},{default:o(()=>[a(t(C),{value:n.allow_test_login,"onUpdate:value":e[3]||(e[3]=l=>n.allow_test_login=l)},null,8,["value"]),a(t(b),{depth:"3",class:"ml-2"},{default:o(()=>[...e[23]||(e[23]=[p("ç®¡ç†å“¡èˆ‡æ¸¬è©¦å¸³è™Ÿ",-1)])]),_:1})]),_:1}),a(t(i),{span:12,label:"è¨»å†ŠåŠŸèƒ½é–‹é—œ",path:"registration_enabled"},{default:o(()=>[a(t(C),{value:n.registration_enabled,"onUpdate:value":e[4]||(e[4]=l=>n.registration_enabled=l)},null,8,["value"]),a(t(b),{type:n.registration_enabled?"success":"error",class:"ml-2"},{default:o(()=>[p(z(n.registration_enabled?"é–‹æ”¾è¨»å†Š":"é—œé–‰è¨»å†Š"),1)]),_:1},8,["type"])]),_:1}),a(t(i),{span:24},{default:o(()=>[a(t(N),{"title-placement":"left"},{default:o(()=>[...e[24]||(e[24]=[p("ç¶²ç«™åŸºç¤Žè¨­å®š",-1)])]),_:1})]),_:1}),a(t(i),{span:24,label:"ç¶²ç«™æ¨™é¡Œ",path:"site_title"},{default:o(()=>[a(t(T),{value:n.site_title,"onUpdate:value":e[5]||(e[5]=l=>n.site_title=l),placeholder:"ç€è¦½å™¨åˆ†é èˆ‡æ¨™é¡Œ"},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"é è¨­èªžç³»",path:"default_language"},{default:o(()=>[a(t(M),{value:n.default_language,"onUpdate:value":e[6]||(e[6]=l=>n.default_language=l),options:E},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"æ™‚å€è¨­å®š",path:"timezone"},{default:o(()=>[a(t(M),{value:n.timezone,"onUpdate:value":e[7]||(e[7]=l=>n.timezone=l),options:J},null,8,["value"])]),_:1}),a(t(i),{span:24},{default:o(()=>[a(t(N),{"title-placement":"left"},{default:o(()=>[...e[25]||(e[25]=[p("æŽ¨å»£èˆ‡è²¡å‹™åƒæ•¸",-1)])]),_:1})]),_:1}),a(t(i),{span:12,label:"P2P äº¤æ˜“æ‰‹çºŒè²» (%)",path:"p2p_transaction_fee"},{default:o(()=>[a(t(c),{value:n.p2p_transaction_fee,"onUpdate:value":e[8]||(e[8]=l=>n.p2p_transaction_fee=l),precision:2,min:0,max:100},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"æ´»å‹•éŒ¢åŒ…æµæ°´å€æ•¸ (M)",path:"bonus_rollover_multiplier"},{feedback:o(()=>[n.bonus_rollover_multiplier===0?(d(),P(t(b),{key:0,type:"info"},{default:o(()=>[...e[26]||(e[26]=[p(" ðŸ’¡ è¨­ç‚º 0 ä»£è¡¨ç„¡éœ€æµæ°´ç›´æŽ¥è½‰åŒ– ",-1)])]),_:1})):k("",!0)]),default:o(()=>[a(t(c),{value:n.bonus_rollover_multiplier,"onUpdate:value":e[9]||(e[9]=l=>n.bonus_rollover_multiplier=l),precision:1,min:0},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"è¨»å†Šè´ˆé»žé‡‘é¡",path:"registration_bonus_amount"},{default:o(()=>[a(t(c),{value:n.registration_bonus_amount,"onUpdate:value":e[10]||(e[10]=l=>n.registration_bonus_amount=l),min:0},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"æµæ°´çµç®—æ¥µå°å€¼",path:"rollover_settlement_threshold"},{default:o(()=>[a(t(c),{value:n.rollover_settlement_threshold,"onUpdate:value":e[11]||(e[11]=l=>n.rollover_settlement_threshold=l),min:0,step:.01},null,8,["value"])]),_:1}),a(t(i),{span:24},{default:o(()=>[a(t(N),{"title-placement":"left"},{default:o(()=>[...e[27]||(e[27]=[p("å®‰å…¨æ€§è¨­å®š",-1)])]),_:1})]),_:1}),a(t(i),{span:12,label:"ç™»å…¥éŒ¯èª¤ä¸Šé™",path:"login_error_limit"},{default:o(()=>[a(t(c),{value:n.login_error_limit,"onUpdate:value":e[12]||(e[12]=l=>n.login_error_limit=l),min:1,max:20},null,8,["value"])]),_:1}),a(t(i),{span:12,label:"é©—è­‰ç¢¼é–‹é—œ",path:"captcha_enabled"},{default:o(()=>[a(t(C),{value:n.captcha_enabled,"onUpdate:value":e[13]||(e[13]=l=>n.captcha_enabled=l)},null,8,["value"]),a(t(b),{depth:"3",class:"ml-2"},{default:o(()=>[...e[28]||(e[28]=[p("ç™»å…¥èˆ‡è¨»å†Šé é¢",-1)])]),_:1})]),_:1}),a(t(i),{span:12,label:"å¼·åˆ¶æ‰‹æ©Ÿç¶å®š",path:"force_phone_binding"},{default:o(()=>[a(t(C),{value:n.force_phone_binding,"onUpdate:value":e[14]||(e[14]=l=>n.force_phone_binding=l)},null,8,["value"])]),_:1}),a(t(i),{span:24,label:"ç™½åå–® IP",path:"whitelist_ips"},{default:o(()=>[a(t(T),{value:n.whitelist_ips,"onUpdate:value":e[15]||(e[15]=l=>n.whitelist_ips=l),type:"textarea",placeholder:"è¼¸å…¥å…è¨±è·³éŽç¶­è­·é™åˆ¶çš„ IP ç¯„åœï¼ˆæ¯è¡Œä¸€å€‹ï¼‰",rows:3},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["model"]),a(t(N)),a(t(me),{justify:"space-between",style:{"margin-top":"16px"}},{default:o(()=>[m.value?(d(),P(t(b),{key:0,type:"hint"},{default:o(()=>[p(" æœ€å¾Œæ›´æ–°ï¼š"+z(Y(m.value.updated_at))+" by "+z(m.value.updated_by),1)]),_:1})):k("",!0),a(t(A),{text:"",type:"primary",onClick:e[16]||(e[16]=l=>g.value=!0)},{default:o(()=>[...e[29]||(e[29]=[p(" æŸ¥çœ‹è®Šæ›´æ­·å² ",-1)])]),_:1})]),_:1})],64))]),_:1},8,["title"]),a(t(ie),{show:g.value,"onUpdate:show":e[18]||(e[18]=l=>g.value=l),title:"ç·¨è¼¯è®Šæ›´åŽŸå› ",preset:"dialog","positive-text":"ç¢ºèª","negative-text":"å–æ¶ˆ",onPositiveClick:Q,onNegativeClick:e[19]||(e[19]=l=>g.value=!1)},{default:o(()=>[a(t(W),{label:"è®Šæ›´åŽŸå› "},{default:o(()=>[a(t(T),{value:h.value,"onUpdate:value":e[17]||(e[17]=l=>h.value=l),type:"textarea",placeholder:"è«‹å¡«å¯«æ­¤æ¬¡è®Šæ›´çš„åŽŸå› ï¼ˆä¾›å¯©è¨ˆæ—¥èªŒä½¿ç”¨ï¼‰",rows:4,clearable:""},null,8,["value"])]),_:1})]),_:1},8,["show"])]))}}),De=ue(ce,[["__scopeId","data-v-0fd4ae80"]]);export{De as default};
