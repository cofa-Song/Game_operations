import{e as q,P as J,y as K,a0 as G,o as Y,v as C,E as a,D as l,F as t,Q as x,Y as Z,Z as w,K as y,J as d,G as p,W as M,C as R,a1 as X,N as ee,r as b,h as N,M as te,s as S,_ as ae}from"./index-BsKuKuBe.js";import{S as le}from"./Search-CuvCQVWn.js";import{N as k}from"./Select-CCDzjsmj.js";import{N as re}from"./Icon-CbayTH31.js";import{N as se}from"./DataTable-D5mRR0cm.js";import{N as A}from"./Space-Cf9Hs1lp.js";import{N as oe,a as m}from"./DescriptionsItem-cwe7Zw2M.js";import{N as g}from"./Tag-I3_cH6qL.js";import{N as ne}from"./text-BDsrB_Xz.js";import"./Popover-CfBNgOAF.js";import"./use-compitable-BjMNwQgq.js";import"./create-Bj8PAPmY.js";import"./Empty-DtuLCoXR.js";import"./Radio-C5fS5KPL.js";import"./RadioGroup-CgIVku-C.js";import"./Tooltip-XZFA5Owl.js";import"./Dropdown-CcmdnIk3.js";import"./use-keyboard-kkRvbDTj.js";import"./create-ref-setter-C4J8sofl.js";import"./Pagination-BLbp2o8H.js";import"./Forward-CBwL8ab_.js";const F=n=>new Promise(o=>setTimeout(o,n));let H=[{id:"R_20260204_0001",playerId:"10086",playerName:"player888",type:"IP_CONFLICT",level:"HIGH",description:"Linked with 4 diff accounts on same IP (192.168.1.10)",triggerTime:new Date(Date.now()-36e5).toISOString(),status:"PENDING"},{id:"R_20260204_0002",playerId:"10099",playerName:"winner99",type:"BIG_WIN",level:"MEDIUM",description:"Single win 5000x bet amount in Slot Game",triggerTime:new Date(Date.now()-72e5).toISOString(),status:"PENDING"},{id:"R_20260204_0003",playerId:"10101",playerName:"tester01",type:"DEVICE_CONFLICT",level:"LOW",description:"Device ID matched with previous banned user",triggerTime:new Date(Date.now()-864e5).toISOString(),status:"RESOLVED",operator:"admin"}];const V={async getAlerts(n){await F(500);let o=[...H];return n.status&&(o=o.filter(i=>i.status===n.status)),n.type&&(o=o.filter(i=>i.type===n.type)),n.level&&(o=o.filter(i=>i.level===n.level)),o.sort((i,c)=>new Date(c.triggerTime).getTime()-new Date(i.triggerTime).getTime()),{code:0,msg:"success",data:{list:o,total:o.length}}},async updateAlertStatus(n,o,i){await F(300);const c=H.find(E=>E.id===n);return c&&(c.status=o,c.operator=i),{code:0,msg:"success",data:null}}},ie={class:"risk-alert-container"},ue={key:0},de={key:0},pe=q({__name:"AlertList",setup(n){const o=te(),i=ee(),c=J(),E=K(),D=b(!1),T=b([]),_=b(!1),s=b(null),v=G({status:i.query.status||void 0,type:void 0,level:void 0,page:1,pageSize:10}),I=G({page:1,pageSize:10,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50]}),z=[{label:"待處理",value:"PENDING"},{label:"處理中",value:"PROCESSING"},{label:"已處置",value:"RESOLVED"},{label:"誤報解除",value:"DISMISSED"}],U=[{label:"IP 關聯",value:"IP_CONFLICT"},{label:"設備關聯",value:"DEVICE_CONFLICT"},{label:"電子爆獎",value:"BIG_WIN"},{label:"頻繁轉帳",value:"HIGH_FREQ_TRANSFER"}],B=[{label:"Low",value:"LOW"},{label:"Medium",value:"MEDIUM"},{label:"High",value:"HIGH"}],h=e=>{switch(e){case"HIGH":return"error";case"MEDIUM":return"warning";default:return"info"}},O=e=>{switch(e){case"PENDING":return"error";case"PROCESSING":return"warning";case"RESOLVED":return"success";case"DISMISSED":return"default";default:return"default"}},W=()=>"default",$=[{title:"編號",key:"id",width:140},{title:"玩家",key:"playerName",render(e){return N(y,{text:!0,type:"primary",onClick:()=>P(e.playerId)},{default:()=>e.playerName})}},{title:"類型",key:"type",render(e){return N(g,{bordered:!1},{default:()=>e.type})}},{title:"等級",key:"level",render(e){return N(g,{type:h(e.level)},{default:()=>e.level})}},{title:"時間",key:"triggerTime",render(e){return new Date(e.triggerTime).toLocaleString()}},{title:"狀態",key:"status",render(e){return N(g,{type:O(e.status)},{default:()=>e.status})}},{title:"操作",key:"actions",render(e){return N(y,{size:"small",onClick:()=>j(e)},{default:()=>"查看"})}}],f=async()=>{D.value=!0;try{const e=await V.getAlerts({...v,page:I.page,pageSize:I.pageSize});e.code===0&&e.data&&(T.value=e.data.list,I.itemCount=e.data.total)}catch{c.error("載入失敗")}finally{D.value=!1}},Q=e=>{I.page=e,f()},j=e=>{s.value=e,_.value=!0},L=async e=>{var r;if(s.value)try{await V.updateAlertStatus(s.value.id,e,((r=E.user)==null?void 0:r.name)||"admin"),c.success("處置成功"),_.value=!1,f()}catch{c.error("操作失敗")}},P=e=>{o.push(`/admin/players/${e}`)};return Y(()=>{f()}),(e,r)=>(S(),C("div",ie,[a(t(A),{vertical:"",size:"large"},{default:l(()=>[a(t(x),null,{default:l(()=>[a(t(Z),{inline:"","label-placement":"left","show-feedback":!1},{default:l(()=>[a(t(w),{label:"狀態"},{default:l(()=>[a(t(k),{value:v.status,"onUpdate:value":[r[0]||(r[0]=u=>v.status=u),f],options:z,clearable:"",placeholder:"全部",style:{width:"140px"}},null,8,["value"])]),_:1}),a(t(w),{label:"類型"},{default:l(()=>[a(t(k),{value:v.type,"onUpdate:value":[r[1]||(r[1]=u=>v.type=u),f],options:U,clearable:"",placeholder:"全部",style:{width:"160px"}},null,8,["value"])]),_:1}),a(t(w),{label:"風險等級"},{default:l(()=>[a(t(k),{value:v.level,"onUpdate:value":[r[2]||(r[2]=u=>v.level=u),f],options:B,clearable:"",placeholder:"全部",style:{width:"120px"}},null,8,["value"])]),_:1}),a(t(w),null,{default:l(()=>[a(t(y),{type:"primary",onClick:f,loading:D.value},{icon:l(()=>[a(t(re),null,{default:l(()=>[a(t(le))]),_:1})]),default:l(()=>[r[7]||(r[7]=d(" 查詢 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(t(x),null,{default:l(()=>[a(t(se),{columns:$,data:T.value,loading:D.value,pagination:I,"onUpdate:page":Q},null,8,["data","loading","pagination"])]),_:1})]),_:1}),a(t(X),{show:_.value,"onUpdate:show":r[6]||(r[6]=u=>_.value=u),preset:"card",title:"預警處置詳情",style:{width:"600px"}},{footer:l(()=>[s.value?(S(),C("div",de,[s.value.status==="PENDING"||s.value.status==="PROCESSING"?(S(),R(t(A),{key:0,justify:"end"},{default:l(()=>[a(t(y),{type:"warning",onClick:r[4]||(r[4]=u=>L("DISMISSED"))},{default:l(()=>[...r[8]||(r[8]=[d(" 誤報解除 ",-1)])]),_:1}),a(t(y),{type:"error",onClick:r[5]||(r[5]=u=>L("RESOLVED"))},{default:l(()=>[...r[9]||(r[9]=[d(" 確認處置 (限制帳號) ",-1)])]),_:1})]),_:1})):(S(),R(t(ne),{key:1,class:"done-text"},{default:l(()=>[d(" 已於 "+p(new Date().toLocaleDateString())+" 由 "+p(s.value.operator)+" 結案 ",1)]),_:1}))])):M("",!0)]),default:l(()=>[s.value?(S(),C("div",ue,[a(t(oe),{bordered:"",column:1,"label-placement":"left","label-width":"120px"},{default:l(()=>[a(t(m),{label:"預警編號"},{default:l(()=>[d(p(s.value.id),1)]),_:1}),a(t(m),{label:"玩家"},{default:l(()=>[a(t(y),{text:"",type:"primary",onClick:r[3]||(r[3]=u=>P(s.value.playerId))},{default:l(()=>[d(p(s.value.playerName)+" (ID: "+p(s.value.playerId)+") ",1)]),_:1})]),_:1}),a(t(m),{label:"觸發時間"},{default:l(()=>[d(p(new Date(s.value.triggerTime).toLocaleString()),1)]),_:1}),a(t(m),{label:"預警類型"},{default:l(()=>[a(t(g),{type:W()},{default:l(()=>[d(p(s.value.type),1)]),_:1},8,["type"])]),_:1}),a(t(m),{label:"風險等級"},{default:l(()=>[a(t(g),{type:h(s.value.level)},{default:l(()=>[d(p(s.value.level),1)]),_:1},8,["type"])]),_:1}),a(t(m),{label:"異常內容"},{default:l(()=>[d(p(s.value.description),1)]),_:1}),a(t(m),{label:"目前狀態"},{default:l(()=>[a(t(g),{type:O(s.value.status)},{default:l(()=>[d(p(s.value.status),1)]),_:1},8,["type"])]),_:1})]),_:1})])):M("",!0)]),_:1},8,["show"])]))}}),Ge=ae(pe,[["__scopeId","data-v-c8de972c"]]);export{Ge as default};
