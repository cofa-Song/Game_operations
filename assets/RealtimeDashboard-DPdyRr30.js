import{i as D}from"./index-D5fw03LZ.js";import{P as U}from"./PulseOutline-CvB9uYtt.js";import{aB as P,aC as j,e as V,ac as X,r as w,o as C,aD as $,j as k,L as q,l as H,B as J,v as K,E as e,D as l,F as t,Q as h,J as M,G as Q,K as W,T as A,U as g,w as E,s as Y,_ as Z}from"./index-BsKuKuBe.js";import{R as ee}from"./Refresh-N_ZHlcGf.js";import{t as z}from"./toNumber-By67wpTM.js";import{P as te}from"./PeopleOutline-CQmmVffL.js";import{P as ae}from"./PersonOutline-mWqrqeav.js";import{N as y}from"./Space-Cf9Hs1lp.js";import{N as T}from"./text-BDsrB_Xz.js";import{N as R}from"./Icon-CbayTH31.js";import{N as oe}from"./Switch-DXNn_bI_.js";import{N as le}from"./Divider-DILe50Hg.js";import{N as S}from"./Statistic-C8A6-kum.js";import"./use-compitable-BjMNwQgq.js";var O=1/0,re=17976931348623157e292;function ne(a){if(!a)return a===0?a:0;if(a=z(a),a===O||a===-O){var o=a<0?-1:1;return o*re}return a===a?a:0}function ie(a){var o=ne(a),n=o%1;return o===o?n?o-n:o:0}var se=j.isFinite,ue=Math.min;function fe(a){var o=Math[a];return function(n,r){if(n=z(n),r=r==null?0:ue(ie(r),292),r&&se(n)){var s=(P(n)+"e").split("e"),u=o(s[0]+"e"+(+s[1]+r));return s=(P(u)+"e").split("e"),+(s[0]+"e"+(+s[1]-r))}return o(n)}}var de=fe("round");const ce=a=>1-Math.pow(1-a,5);function me(a){const{from:o,to:n,duration:r,onUpdate:s,onFinish:u}=a,d=performance.now(),f=()=>{const v=performance.now(),p=Math.min(v-d,r),N=o+(n-o)*ce(p/r);if(p===r){u();return}s(N),requestAnimationFrame(f)};f()}const ve={to:{type:Number,default:0},precision:{type:Number,default:0},showSeparator:Boolean,locale:String,from:{type:Number,default:0},active:{type:Boolean,default:!0},duration:{type:Number,default:2e3},onFinish:Function},x=V({name:"NumberAnimation",props:ve,setup(a){const{localeRef:o}=X("name"),{duration:n}=a,r=w(a.from),s=k(()=>{const{locale:i}=a;return i!==void 0?i:o.value});let u=!1;const d=i=>{r.value=i},f=()=>{var i;r.value=a.to,u=!1,(i=a.onFinish)===null||i===void 0||i.call(a)},v=(i=a.from,b=a.to)=>{u=!0,r.value=a.from,i!==b&&me({from:i,to:b,duration:n,onUpdate:d,onFinish:f})},p=k(()=>{var i;const _=de(r.value,a.precision).toFixed(a.precision).split("."),m=new Intl.NumberFormat(s.value),c=(i=m.formatToParts(.5).find(L=>L.type==="decimal"))===null||i===void 0?void 0:i.value,F=a.showSeparator?m.format(Number(_[0])):_[0],G=_[1];return{integer:F,decimal:G,decimalSeparator:c}});function N(){u||v()}return C(()=>{$(()=>{a.active&&v()})}),Object.assign({formattedValue:p},{play:N})},render(){const{formattedValue:{integer:a,decimal:o,decimalSeparator:n}}=this;return[a,o?n:null,o]}}),pe=a=>new Promise(o=>setTimeout(o,a)),he={async getRealtimeStats(a=!1){await pe(300);let o=12500,n=45e3,r=15e6,s=r*.035;const u=Math.random()*.05;return o=Math.floor(o*(1+u)),r=Math.floor(r*(1+u/2)),s=Math.floor(r*.035),a&&(o=Math.floor(o*.85),n=Math.floor(n*.9),r=Math.floor(r*.95),s=Math.floor(r*.04)),{code:0,msg:"success",data:{ccu:o,dau:n,ggr:s,totalBet:r,providerStats:[{name:"Evolution",value:Math.floor(o*.4)},{name:"PG Soft",value:Math.floor(o*.3)},{name:"Pragmatic",value:Math.floor(o*.2)},{name:"Other",value:Math.floor(o*.1)}],deviceStats:[{name:"Mobile App (iOS)",value:Math.floor(o*.45)},{name:"Mobile App (Android)",value:Math.floor(o*.35)},{name:"Mobile Web",value:Math.floor(o*.1)},{name:"Desktop",value:Math.floor(o*.1)}]}}}},_e={class:"realtime-dashboard"},B=10,ge=V({__name:"RealtimeDashboard",setup(a){const o=w(!0),n=w(B),r=w({ccu:0,dau:0,ggr:0,totalBet:0,providerStats:[],deviceStats:[]}),s=w(null),u=w(null);let d=null,f=null,v=null,p=null;const N=()=>{s.value&&(d=D(s.value)),u.value&&(f=D(u.value)),I()},I=()=>{d&&d.setOption({tooltip:{trigger:"item"},legend:{show:!1},series:[{name:"Provider",type:"pie",radius:"55%",data:r.value.providerStats,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),f&&f.setOption({tooltip:{trigger:"item"},legend:{show:!1},series:[{name:"Device",type:"pie",radius:"55%",data:r.value.deviceStats,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]})},i=async()=>{try{const m=await he.getRealtimeStats(o.value);m.code===0&&m.data&&(r.value=m.data,I(),n.value=B)}catch(m){console.error(m)}},b=()=>{v=window.setInterval(i,B*1e3),p=window.setInterval(()=>{n.value>0&&n.value--},1e3)};C(()=>{i(),q(()=>{N(),window.addEventListener("resize",_)}),b()}),H(()=>{v&&clearInterval(v),p&&clearInterval(p),window.removeEventListener("resize",_),d==null||d.dispose(),f==null||f.dispose()});const _=()=>{d==null||d.resize(),f==null||f.resize()};return J(o,()=>{i()}),(m,c)=>(Y(),K("div",_e,[e(t(y),{vertical:"",size:"large"},{default:l(()=>[e(t(h),null,{default:l(()=>[e(t(y),{justify:"space-between",align:"center"},{default:l(()=>[e(t(T),{h2:"",style:{margin:"0"}},{default:l(()=>[e(t(R),null,{default:l(()=>[e(t(U))]),_:1}),c[1]||(c[1]=M(" 即時運作數據 (Realtime Ops) ",-1))]),_:1}),e(t(y),{align:"center",size:"large"},{default:l(()=>[e(t(y),{align:"center"},{default:l(()=>[e(t(T),null,{default:l(()=>[...c[2]||(c[2]=[M("排除測試帳號",-1)])]),_:1}),e(t(oe),{value:o.value,"onUpdate:value":[c[0]||(c[0]=F=>o.value=F),i]},null,8,["value"])]),_:1}),e(t(le),{vertical:""}),e(t(T),{depth:"3",class:"text-xs"},{default:l(()=>[M(" 自動刷新: "+Q(n.value)+"s ",1)]),_:1}),e(t(W),{circle:"",size:"small",onClick:i},{icon:l(()=>[e(t(R),null,{default:l(()=>[e(t(ee))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(t(A),{"x-gap":"12","y-gap":"12",cols:4},{default:l(()=>[e(t(g),null,{default:l(()=>[e(t(h),{class:"kpi-card",hoverable:""},{default:l(()=>[e(t(S),{label:"即時在線 (CCU)"},{prefix:l(()=>[e(t(R),null,{default:l(()=>[e(t(te))]),_:1})]),default:l(()=>[e(t(x),{from:0,to:r.value.ccu},null,8,["to"])]),_:1})]),_:1})]),_:1}),e(t(g),null,{default:l(()=>[e(t(h),{class:"kpi-card",hoverable:""},{default:l(()=>[e(t(S),{label:"今日累積 DAU"},{prefix:l(()=>[e(t(R),null,{default:l(()=>[e(t(ae))]),_:1})]),default:l(()=>[e(t(x),{from:0,to:r.value.dau},null,8,["to"])]),_:1})]),_:1})]),_:1}),e(t(g),null,{default:l(()=>[e(t(h),{class:"kpi-card",hoverable:""},{default:l(()=>[e(t(S),{label:"今日即時 GGR"},{prefix:l(()=>[...c[3]||(c[3]=[M("$",-1)])]),default:l(()=>[e(t(x),{from:0,to:r.value.ggr},null,8,["to"])]),_:1})]),_:1})]),_:1}),e(t(g),null,{default:l(()=>[e(t(h),{class:"kpi-card",hoverable:""},{default:l(()=>[e(t(S),{label:"今日總投注 (Turnover)"},{prefix:l(()=>[...c[4]||(c[4]=[M("$",-1)])]),default:l(()=>[e(t(x),{from:0,to:r.value.totalBet},null,8,["to"])]),_:1})]),_:1})]),_:1})]),_:1}),e(t(A),{"x-gap":"12","y-gap":"12",cols:2},{default:l(()=>[e(t(g),null,{default:l(()=>[e(t(h),{title:"各平台人數分布 (Provider Distribution)"},{default:l(()=>[E("div",{ref_key:"providerChartRef",ref:s,style:{height:"350px"}},null,512)]),_:1})]),_:1}),e(t(g),null,{default:l(()=>[e(t(h),{title:"各裝置人數分布 (Device Distribution)"},{default:l(()=>[E("div",{ref_key:"deviceChartRef",ref:u,style:{height:"350px"}},null,512)]),_:1})]),_:1})]),_:1})]),_:1})]))}}),ke=Z(ge,[["__scopeId","data-v-3a24545d"]]);export{ke as default};
