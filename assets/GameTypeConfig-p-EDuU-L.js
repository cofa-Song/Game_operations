import{c as x}from"./config-DZ_tPtnd.js";import{e as T,A as D,P as B,h,K as g,o as E,v as w,E as o,D as s,w as n,G as r,F as e,J as v,Q as F,W as G,Y as I,Z as M,a1 as R,r as u,s as b}from"./index-BsKuKuBe.js";import{C as V}from"./CreateOutline-CbXbgX50.js";import{R as A}from"./RefreshOutline-DGpX8rVm.js";import{N as O}from"./DataTable-D5mRR0cm.js";import{N as S}from"./InputNumber-BMu_ZOnr.js";import"./Radio-C5fS5KPL.js";import"./RadioGroup-CgIVku-C.js";import"./Tooltip-XZFA5Owl.js";import"./Popover-CfBNgOAF.js";import"./use-compitable-BjMNwQgq.js";import"./Dropdown-CcmdnIk3.js";import"./Icon-CbayTH31.js";import"./create-Bj8PAPmY.js";import"./use-keyboard-kkRvbDTj.js";import"./create-ref-setter-C4J8sofl.js";import"./Select-CCDzjsmj.js";import"./Tag-I3_cH6qL.js";import"./Empty-DtuLCoXR.js";import"./Pagination-BLbp2o8H.js";import"./Forward-CBwL8ab_.js";import"./Add-BJRbFrfV.js";const U={class:"p-6"},Z={class:"mb-4 p-4 bg-blue-50 rounded text-sm text-gray-700"},$={key:0,class:"mb-4 p-3 bg-gray-50 rounded"},j={class:"font-semibold"},q={class:"text-xs text-gray-500"},z={class:"text-xs text-gray-500 mt-2"},J={class:"flex justify-end gap-2"},ge=T({__name:"GameTypeConfig",setup(K){const{t}=D(),d=B(),p=u(!1),_=u([]),m=u(!1),l=u(null),c=u({rate:100}),N=[{title:"ID",key:"id",width:80},{title:t("game.config.typeName"),key:"name",width:150},{title:t("game.config.typeCode"),key:"code",width:120},{title:t("game.config.rate"),key:"rate",width:150,render:a=>h("span",{class:"font-mono font-semibold"},`${a.rate}%`)},{title:t("game.provider.updatedAt"),key:"updated_at",width:180,render:a=>a.updated_at.replace("T"," ").replace("Z","").slice(0,19)},{title:t("common.action"),key:"actions",width:100,fixed:"right",render:a=>h(g,{size:"small",secondary:!0,onClick:()=>k(a)},{default:()=>t("common.edit"),icon:()=>h(V)})}],y=async()=>{p.value=!0;try{const a=await x.getGameTypes();a.code===0?_.value=a.data:d.error(a.msg)}catch{d.error(t("common.error"))}finally{p.value=!1}},k=a=>{l.value=a,c.value={rate:a.rate},m.value=!0},C=async()=>{if(l.value)try{const a=await x.updateGameType(l.value.id,c.value);a.code===0?(d.success(t("common.success")),m.value=!1,y()):d.error(a.msg)}catch{d.error(t("common.error"))}};return E(()=>{y()}),(a,i)=>(b(),w("div",U,[o(e(F),{title:e(t)("game.config.typeTitle")},{"header-extra":s(()=>[o(e(g),{secondary:"",onClick:y,loading:p.value},{icon:s(()=>[o(e(A))]),default:s(()=>[v(" "+r(e(t)("common.search")),1)]),_:1},8,["loading"])]),default:s(()=>[n("div",Z,[n("strong",null,r(e(t)("common.info"))+"：",1),v(r(e(t)("game.config.typeRateDesc")),1)]),o(e(O),{columns:N,data:_.value,loading:p.value,pagination:!1,bordered:!1},null,8,["data","loading"])]),_:1},8,["title"]),o(e(R),{show:m.value,"onUpdate:show":i[2]||(i[2]=f=>m.value=f),preset:"card",title:e(t)("game.config.rate"),style:{width:"450px"}},{footer:s(()=>[n("div",J,[o(e(g),{onClick:i[1]||(i[1]=f=>m.value=!1)},{default:s(()=>[v(r(e(t)("common.cancel")),1)]),_:1}),o(e(g),{type:"primary",onClick:C},{default:s(()=>[v(r(e(t)("common.save")),1)]),_:1})])]),default:s(()=>[l.value?(b(),w("div",$,[n("div",j,r(l.value.name),1),n("div",q,r(l.value.code)+" | "+r(l.value.id),1)])):G("",!0),o(e(I),{model:c.value,"label-placement":"left","label-width":"120"},{default:s(()=>[o(e(M),{label:e(t)("game.config.rate"),required:""},{default:s(()=>[o(e(S),{value:c.value.rate,"onUpdate:value":i[0]||(i[0]=f=>c.value.rate=f),min:0,max:1e3,step:10,style:{width:"100%"},suffix:"%"},null,8,["value"])]),_:1},8,["label"]),n("div",z,r(e(t)("game.config.typeRateDesc").split("。")[1]),1)]),_:1},8,["model"])]),_:1},8,["show","title"])]))}});export{ge as default};
