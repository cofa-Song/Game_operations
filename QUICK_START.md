# 快速開始指南

## 🚀 項目啟動

### 1. 安裝依賴
```bash
npm install
```

### 2. 啟動開發服務器
```bash
npm run dev
```

服務器將在 `http://localhost:5173` 啟動（如果 5173 被佔用會自動使用 5174）

### 3. 構建生產版本
```bash
npm run build
```

---

## 🔐 登入測試

### 快速登入帳號

進入登入頁面後，可點擊下方「快速登入」按鈕，選擇對應身份快速登入：

#### 👨‍💻 技術開發
- **帳號**：dev_admin
- **密碼**：dev123456
- **權限**：全局系統管理，可訪問所有功能
- **推薦用途**：測試系統設定、所有管理功能

#### 👔 營運總監
- **帳號**：manager_admin  
- **密碼**：manager123456
- **權限**：管理員管理、群組管理，看不到系統設定
- **推薦用途**：測試營運管理功能、帳號權限管理

#### 👤 客服人員
- **帳號**：service_user1
- **密碼**：user123456
- **權限**：客服組權限（唯讀功能、無操作權限）
- **推薦用途**：測試權限限制、群組繼承

#### 👤 財務人員
- **帳號**：finance_user1
- **密碼**：user123456
- **權限**：財務組權限（財務相關全部操作權限）
- **推薦用途**：測試多群組權限、權限聯集

#### 👤 運營人員
- **帳號**：ops_user1
- **密碼**：user123456
- **權限**：運營組權限（大部分操作權限）
- **推薦用途**：測試群組權限管理、完整操作流程

---

## 📍 功能導航

### 個人帳號管理 (OPE-105)
**路由**：`/admin/account`

進入方式：
1. 登入系統
2. 點擊右上角頭像/個人菜單 → 個人帳號
3. 修改個人資訊、密碼、語言設定

**可測試功能**：
- ✅ 修改個人信息
- ✅ 變更密碼（需驗證複雜度）
- ✅ 啟用/禁用 2FA
- ✅ 密碼變更後強制重新登入

---

### 群組管理 (OPE-102)
**路由**：`/admin/groups`

進入方式：
1. 以開發者或營運管理者登入
2. 側邊菜單 → 群組管理
3. 或直接訪問 `/admin/groups`

**可測試功能**：
- ✅ 查看群組列表
- ✅ 新增群組（分配功能權限）
- ✅ 編輯群組（修改權限模板）
- ✅ 群組狀態開關（啟用/停用）
- ✅ 成員管理（新增/移除成員）
- ✅ 刪除群組（有成員時會提示無法刪除）

**重要提示**：
- 營運管理者看不到「系統設定」模組的權限
- 群組有成員時無法刪除
- 成員變更即時生效

---

### 帳號管理 (OPE-103)
**路由**：`/admin/accounts`

進入方式：
1. 以開發者或營運管理者登入
2. 側邊菜單 → 帳號管理
3. 或直接訪問 `/admin/accounts`

**可測試功能**：
- ✅ 查看帳號列表（角色過濾、數據隔離）
- ✅ 新增帳號（自動驗證唯一性）
- ✅ 編輯帳號（修改資訊、角色、群組）
- ✅ 帳號狀態切換（啟用↔停用↔鎖定）
- ✅ 權限稽核（查看實際有效權限）
- ✅ 刪除帳號（軟刪除）
- ✅ 顯示已刪除帳號

**重要提示**：
- 開發者帳號只有開發者可見
- 營運管理者看不到開發者帳號
- 一般使用者只能看同群組成員
- 權限稽核顯示聯集計算結果

---

### 操作日誌 (OPE-104)
**路由**：`/admin/logs`

進入方式：
1. 以任何身份登入（一般使用者只能看自己的日誌）
2. 側邊菜單 → 操作日誌
3. 或直接訪問 `/admin/logs`

**可測試功能**：
- ✅ 日誌列表查看
- ✅ 多條件篩選（日期、操作人、模組、操作類型）
- ✅ 日誌詳情查看（三種格式）
- ✅ 重置篩選

**詳情展示**：
- JSON 格式：原始數據展示
- 對照表格式：修改前後數據對比
- 基本資訊：操作元數據、來源IP 等

---

## 🧪 測試場景

### 場景 1：測試權限天花板限制
1. 以營運管理者身份登入
2. 進入群組管理
3. 查看權限樹，確認看不到「系統設定」模組
4. 對比開發者帳號的所有可見權限

### 場景 2：測試權限聯集
1. 以開發者身份登入
2. 進入帳號管理
3. 點擊「財務人員」帳號的「權限稽核」
4. 查看該帳號的實際有效權限
5. 驗證來源為「財務組」

### 場景 3：測試數據隔離
1. 用開發者帳號登入 → 進入帳號管理 → 查看帳號列表
2. 登出，用營運管理者帳號登入 → 進入帳號管理
3. 確認看不到開發者帳號
4. 用一般使用者帳號登入 → 進入帳號管理
5. 確認只能看到同群組成員，且無任何操作按鈕

### 場景 4：測試成員管理
1. 以開發者身份登入
2. 進入群組管理 → 點擊「客服組」的「人員管理」
3. 新增成員到該群組
4. 驗證成員數即時更新
5. 移除成員，驗證成員數減少

### 場景 5：測試帳號操作
1. 以開發者身份登入
2. 進入帳號管理
3. 新增一個新帳號（測試帳號唯一性驗證）
4. 編輯該帳號的資訊和群組
5. 切換帳號狀態（啟用 → 停用）
6. 刪除該帳號
7. 勾選「顯示已刪除」確認帳號確實被軟刪除

### 場景 6：測試密碼變更
1. 以任何帳號登入
2. 進入個人帳號管理
3. 嘗試變更密碼（測試複雜度驗證）
4. 成功變更後自動跳轉至登入頁面
5. 使用新密碼重新登入

---

## 🔍 常見問題

### Q1：如何清空 Mock 數據？
**A**：刷新頁面會重置所有 Mock 數據至初始狀態。如果需要永久保存，需要連接真實後端。

### Q2：一般使用者能進入帳號管理嗎？
**A**：可以進入，但功能受限：
- 只能看到同群組成員
- 無新增/編輯/刪除按鈕
- 只能訪問自己的個人帳號和操作日誌

### Q3：為什麼刪除群組時提示「無法刪除」？
**A**：當群組有成員時無法刪除（軟刪除保護）。先從成員管理中移除所有成員，再刪除群組。

### Q4：權限稽核中的「權限來源」是什麼意思？
**A**：表示該權限由哪個群組賦予。如果有多個群組貢獻權限，會顯示最終決定權限的群組。

### Q5：如何測試營運管理者的權限限制？
**A**：
1. 以管理員身份進入群組管理
2. 查看權限樹，看不到「系統設定」模組
3. 這就是權限天花板限制

### Q6：模擬的 2FA 是什麼？
**A**：目前只是一個開關，沒有實際的驗證流程。實際項目中需要集成 TOTP 或短信驗證。

---

## 📱 後端集成指南

若要連接真實後端，需要修改以下文件：

### 1. API 端點 (`src/api/client.ts`)
```typescript
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:3000/api'
```

### 2. 認證 API (`src/api/auth.ts`)
```typescript
export const authApi = {
  async login(username: string, password: string) {
    // 替換為真實 API 調用
    return apiClient.post('/v2/auth/login', { username, password })
  },
  // ... 其他方法
}
```

### 3. 權限管理 API
創建 `src/api/admin.ts` 並實現：
```typescript
export const adminApi = {
  // 群組管理
  groups: {
    list() { /* */ },
    create() { /* */ },
    update() { /* */ },
    delete() { /* */ }
  },
  
  // 帳號管理
  accounts: {
    list() { /* */ },
    create() { /* */ },
    update() { /* */ },
    delete() { /* */ }
  },
  
  // 操作日誌
  logs: {
    list() { /* */ },
    getDetail() { /* */ }
  }
}
```

### 4. 更新 Mock 導入
在各個組件中，將 Mock 數據替換為真實 API 調用：
```typescript
// 舊方式
import { mockPermissionGroups } from '@/mocks/admin'
const groups = ref([...mockPermissionGroups])

// 新方式
import { adminApi } from '@/api/admin'
onMounted(async () => {
  groups.value = await adminApi.groups.list()
})
```

---

## 📚 相關文檔

- [實現總結](./IMPLEMENTATION_SUMMARY.md) - 詳細的功能說明
- [API 文檔](./API.md) - API 端點文檔（待補充）
- [操作流程](./WORKFLOWS.md) - 詳細的操作步驟（待補充）

---

**祝您測試愉快！** 🎉
